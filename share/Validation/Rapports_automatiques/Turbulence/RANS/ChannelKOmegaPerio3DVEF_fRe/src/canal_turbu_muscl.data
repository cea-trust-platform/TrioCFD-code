# Periodic channel flow with k-omega model #

dimension 3

domaine dom_pb1

# BEGIN MESH #
Mailler dom_pb1
{
  Pave Entree
  {
    Origine 0. 0. 0.
    Nombre_de_Noeuds 3 11 5
    Longueurs 2 2 1
  }
  {
    Bord Entree X = 0 0 <= Y <= 2 0 <= Z <= 1
    Bord Haut   Y = 2 0 <= X <= 2 0 <= Z <= 1
    Bord Bas    Y = 0 0 <= X <= 2 0 <= Z <= 1
    Bord Entree X = 2 0 <= Y <= 2 0 <= Z <= 1
    Bord Devant Z = 0 0 <= X <= 2 0 <= Y <= 2
    Bord Devant Z = 1 0 <= X <= 2 0 <= Y <= 2
  }
}

Tetraedriser dom_pb1
# END MESH #

Corriger_frontiere_periodique { Domaine dom_pb1 Bord Entree }
Corriger_frontiere_periodique { Domaine dom_pb1 Bord Devant }

# Problem definition #
Pb_Hydraulique_Turbulent  pb1

Schema_Euler_implicite sch
Read sch
{
  tinit 0.
  tmax 10000.
  dt_start dt_calc
  dt_min 1.e-5
  dt_max 10.
  # dt_impr 100 #
  dt_sauv 500
  dt_impr 1000.
  seuil_statio 1.e-8
  facsec 1.
  facsec_max 200

  Solveur Implicite
  {
    seuil_convergence_solveur 1.e-13
    solveur gmres { diag seuil 1.e-13 impr controle_residu 1 nb_it_max 5 }
  }
}

VEFpreP1b cubesregu

Associate pb1 dom_pb1
Associate pb1 sch
Discretize pb1 cubesregu

Read pb1
{

  fluide_incompressible {
    gravite champ_uniforme 3 0. 0. 0
    mu Champ_Uniforme  1 3.56e-5
    rho Champ_Uniforme  1 3.85
  }

  Navier_Stokes_Turbulent
  {
    solveur_pression Cholesky { }
    convection { muscl }
    diffusion { }
    Sources { Canal_perio { bord Entree } }
    conditions_initiales { vitesse Champ_Uniforme 3 0.05 0. 0. }
    boundary_conditions
    {
      Haut     paroi_fixe
      Bas      paroi_fixe
      Devant   periodique
      Entree   periodique
    }

    Modele_turbulence K_Omega
    {
      Transport_K_Omega
      {
        convection { muscl }
        diffusion { }
        boundary_conditions
        {
          Devant   periodique
          Entree   periodique
          Haut     paroi
          Bas      paroi
        }
        parametre_equation parametre_implicite
        {
          resolution_explicite
        }
        conditions_initiales { k_omega Champ_Uniforme 2 1 5.556 }
      }
      turbulence_paroi loi_standard_hydr
    }

    Traitement_particulier {
      canal {
        debut_stat 9000.
        fin_stat 10000.
        dt_impr_moy_spat 500.
        dt_impr_moy_temp 500.
      }
    }
  }

  Postraitement {
    format lata
    Sondes
    {
      sonde_He_entree_vdebut vitesse periode 10. points 1  0. 1  0.5
      sonde_He_entree_vfin vitesse periode 10. points 1  1.5 1  0.5
      sonde_He_entree_vfinparoi vitesse periode 10. points 1 1.5 1.9  0.5
      sonde_k K periode 10. segment 20 1.0 0.0 0.5 1.0 2.0 0.5

      coupe_He_long_Vxmilieu vitesse periode 500. segment 20 0 1 0.5 2.0 1 0.5
      coupe_He_long_Vxparoi vitesse periode 500. segment 20 0 1.9 0.5 2.0 1.9 0.5
      coupe_He_long_P pression periode 500. segment 20 0 1 0.5 2.0 1 0.5
      coupe_He_larg_Vz vitesse periode 500. segment 4 1.5 1 0.125 1.5 1 0.875
      coupe_He_larg_Vy vitesse periode 500. segment 10 1.5 0.1 0.5 1.5 1.9 0.5
    }

    Champs dt_post 1000.
    {
      pression elem
      vitesse elem
      distance_paroi_globale elem
    }
  }
}

Solve pb1
End
