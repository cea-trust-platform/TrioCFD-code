dimension 2
Pb_Thermohydraulique_Turbulent_QC pb

Domaine dom

# DEBUT MAILLAGE #
Mailler dom
	{
	Pave Cavite
		{
		Origine 0. 0.
		Nombre_de_Noeuds 17 33 
		Longueurs  0.093764 0.029846
		tanh_taille_premiere_maille 8.29e-5
		}
		{
		Bord periox   X = 0.          0. <= Y <= 0.029846    
		Bord periox   X = 0.093764    0. <= Y <= 0.029846   
		Bord bas      Y = 0.          0. <= X <= 0.093764    
		Bord haut     Y = 0.029846    0. <= X <= 0.093764  
		}
	}
# FIN MAILLAGE #

# DEBUT DECOUPAGE 
Decouper dom
{
	partitionneur Tranche  { tranches 2 3  }
	Larg_joint 2
	Nom_Zones canalQCdt20K
	Periodique 1 periox
}
Fin
 FIN DECOUPAGE #

# DEBUT LECTURE 
Scatter canalQCdt20K.Zones dom
 FIN LECTURE #

VDF dis
/*

Runge_Kutta_Rationnel_ordre_2 sch_ex 
*/

schema_euler_explicite sch_ex
Lire sch_ex
{
        tinit 0.
	nb_pas_dt_max 3000
        tmax 0.25
        dt_min 1.e-11
        dt_max 5.
        dt_impr 1.e-7
        dt_sauv 0.05
	dt_start dt_calc
        seuil_statio 1.e-8
	facsec 0.1
	diffusion_implicite 0
}


Fluide_Quasi_Compressible fluide
Lire fluide
{
        mu Champ_Fonc_Fonction 1 temperature (1.461e-6*((100000./(287.14*val))^1.5)/((100000./(287.14*val))+111.))
        lambda Champ_Fonc_Fonction 1 temperature (1.93198026315789000e-3*((100000./(287.14*val))^1.5)/((100000./(287.14*val))+111.))
        pression 100000.
        loi_etat gaz_parfait 	{
                		Prandtl 0.76
                		Cp 1005
                		gamma 1.4
        			}
	traitement_pth conservation_masse
}

Associer pb dom
Associer pb sch_ex
Associer pb fluide

Discretiser pb dis

Lire pb
{
        Navier_Stokes_Turbulent_QC
        {

                solveur_pression GCP { /* optimized */ precond ssor { omega 1.5 } seuil 1.e-7  }
                convection { quick }
                diffusion { }
                Sources 
		{ 
			Canal_perio { bord periox h 0.0149 } 
		}	
		conditions_initiales 
		{
                        vitesse champ_init_canal_sinal 2  { Ucent 15. h 0.0149  ampli_sin 2. omega 67.01 ampli_bruit 0.0 dir_wall 1 dir_flow 0 }
                }
                conditions_limites 
		{
                        periox   periodique 
			haut     paroi_fixe
			bas      paroi_fixe
                }
		Modele_turbulence sous_maille_wale
		{
			turbulence_paroi negligeable
			cw 0.
		} 
		Traitement_particulier
                    		{
                                Canal
                            			{
                                                dt_impr_moy_spat 0.025
                                                dt_impr_moy_temp 0.025
						debut_stat 10.
						fin_stat 20.
						}
                                } 
  
	}
				
        Convection_Diffusion_Chaleur_Turbulent_QC
        {
                diffusion { }
                convection { quick }
		Sources {	}	
		conditions_initiales { Temperature Champ_Fonc_xyz dom 1 263.+293.*y/0.029846 }
		conditions_limites 
                {
                 	periox periodique 
 		        haut paroi_flux_impose Champ_Front_Uniforme 1  170.
/*			bas paroi_flux_impose Champ_Front_Uniforme 1  -170. */
			bas paroi_temperature_imposee champ_front_uniforme 1 290.
		}
    Modele_turbulence Prandtl
		{ 
 		turbulence_paroi negligeable_scalaire 
		}
        }

        Postraitement
         { 

	
			
			format lata
			Champs dt_post 0.0025
			{
      				vitesse elem
      				masse_volumique elem
temperature_qc elem
viscosite_dynamique elem
				pression elem
      				viscosite_turbulente elem
				Vorticite elem
				Critere_Q elem
         		}
        	 Statistiques dt_post 0.0025
		 {
			t_deb 10. t_fin 20.
			moyenne vitesse
			}										        
        }
	
	sauvegarde formatte canal_turb.sauv

}

Resoudre pb
Fin
 # Canal turbulent anisotherme #
# PARALLEL NOT #

IJK_Grid_Geometry grid_geom
Lire grid_geom
{
  nbelem_i 72
  nbelem_j 48
  uniform_domain_size_i 0.093764
  uniform_domain_size_j 0.062509
  file_coord_k          coord_k_0.txt
  perio_i
  perio_j
}

IJK_Splitting grid_splitting
Lire grid_splitting
{
  ijk_grid_geometry grid_geom
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

IJK_Splitting post_splitting
Lire post_splitting
{
  ijk_grid_geometry grid_geom
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting
  timestep 1
  nb_pas_dt_max 250

/* tinit 0. */
  multigrid_solver
  {
    coarsen_operators 5
    Coarsen_Operator_K { file_z_coord coord_k_1.txt } 
    Coarsen_Operator_K { file_z_coord coord_k_2.txt }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-8
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
sauvegarde_post_instantanes   
  tinit 0.
  
  expression_t_init   293.+293/0.029846*z
  expression_vx_init  3.339*z*(0.029846-z)*4/(0.029846*0.029846)
  expression_vy_init  0.
  expression_vz_init  (sin((x-0.093764)/0.093764*6.28318530717959)*sin(y/0.062509*6.28318530717959)+sin((x-0.093764)/0.093764*6.28318530717959*6)*sin(y/0.062509*6.28318530717959*4)+sin((x-0.093764)/0.093764*6.28318530717959*2)*sin(y/0.062509*6.28318530717959*8))*z*(0.029846-z)*4/(0.029846*0.029846) 

  dt_post             2500
# spectral_splitting  post_splitting
  dt_post_spectral    10000 # 
  dt_sauvegarde       10000

  nom_sauvegarde      dns_1.sauv
  check_stop_file     stop_file

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 586.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.007406252649
}
 # 
Test diffusion turbulente (schema en temps)
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  file_coord_k          coord_k_0.txt
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 15
  multigrid_solver
  {
    coarsen_operators 3
    Coarsen_Operator_K { file_z_coord coord_k_1.txt }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.
  
  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vx_init  2.*0.001*cos(X*6.28318530717958647*8.)*cos(z*6.28318530717958647*8.)
  expression_vy_init  0.
  expression_vz_init  2.*0.001*sin(X*6.28318530717958647*8.)*sin(z*6.28318530717958647*8.)

  dt_post             15
  dt_sauvegarde       15

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  type_velocity_diffusion none

  turbulent_viscosity
  type_velocity_turbulent_diffusion simple
  turbulent_viscosity_model constant
  turbulent_viscosity_model_constant 1e-5

  large_eddy_simulation_formulation velocity

  sauvegarde_post_instantanes
  champs_a_postraiter 1 TOUS

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test diffusivite turbulente (dans energie)
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 100
  nbelem_j 100
  nbelem_k 100
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  uniform_domain_size_k 1.
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 7500
  multigrid_solver
  {
    coarsen_operators 2
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.
  
  diffusion_temp_negligeable

  expression_t_init   400.
  expression_vx_init  0.
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1500
  dt_sauvegarde       1500
  dt_start  .01

  nom_sauvegarde      dns_34.sauv
  check_stop_file     stop_file

  turbulent_diffusivity
  type_scalar_turbulent_diffusion normal
  turbulent_diffusivity_model unsrho
  turbulent_diffusivity_model_constant 4.975124378e-5

  large_eddy_simulation_formulation favre

  sauvegarde_post_instantanes
  champs_a_postraiter 2 TEMPERATURE DIV_LAMBDA_GRAD_T_VOLUME

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 586.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test diffusivite turbulente (dans energie)
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 100
  nbelem_j 100
  nbelem_k 100
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  uniform_domain_size_k 1.
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 2
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.
  
  convection_rho_negligeable

  expression_t_init   293.*(1+exp(-(x-.5)*(x-.5)/(.1*.1)-(y-.5)*(y-.5)/(.1*.1)-(z-.5)*(z-.5)/(.1*.1)))
  expression_vx_init 2.*0.001*sin(X*6.28318530717958647)*sin(z*6.28318530717958647*2.)
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_34.sauv
  check_stop_file     stop_file

  turbulent_diffusivity
  type_scalar_turbulent_diffusion normal
  turbulent_diffusivity_model smagorinsky
  turbulent_diffusivity_model_constant .16

  large_eddy_simulation_formulation velocity

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 3 TEMPERATURE DRHO_DT TURBULENT_KAPPA

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test diffusion
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  nbelem_k 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  uniform_domain_size_k 1.
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 2
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.

  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vx_init  0.
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  type_velocity_diffusion none

  structural_uu
  structural_uu_model similarity
  structural_uu_model_constant 1.
  filter_kernel_name box

  large_eddy_simulation_formulation favre

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 D_VELOCITY TEMPERATURE

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test diffusivite turbulente (dans masse)
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 100
  nbelem_j 100
  nbelem_k 100
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  uniform_domain_size_k 1.
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 7500
  multigrid_solver
  {
    coarsen_operators 2
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.
  
  diffusion_temp_negligeable

  expression_t_init   400.
  expression_vx_init  0.
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1500
  dt_sauvegarde       1500
  dt_start  .01

  nom_sauvegarde      dns_34.sauv
  check_stop_file     stop_file

  turbulent_diffusivity
  type_scalar_turbulent_diffusion normal
  turbulent_diffusivity_model constant
  turbulent_diffusivity_model_constant 5e-4

  large_eddy_simulation_formulation velocity

  sauvegarde_post_instantanes
  champs_a_postraiter 2 TEMPERATURE DIV_LAMBDA_GRAD_T_VOLUME

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 586.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test modele gradient pour u*rho
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 100
  nbelem_j 100
  nbelem_k 100
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  uniform_domain_size_k 1.
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 2
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.
  
  convection_rho_negligeable

  expression_t_init   293.*(1+exp(-(x-.5)*(x-.5)/(.1*.1)-(y-.5)*(y-.5)/(.1*.1)-(z-.5)*(z-.5)/(.1*.1)))
  expression_vx_init 2.*0.001*sin(X*6.28318530717958647)*sin(z*6.28318530717958647*2.)
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_34.sauv
  check_stop_file     stop_file

  structural_uscalar
  structural_uscalar_model gradient
  structural_uscalar_model_constant 1.

  large_eddy_simulation_formulation velocity

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 5 TEMPERATURE DRHO_DT STRUCTURAL_USCALAR_X STRUCTURAL_USCALAR_Y STRUCTURAL_USCALAR_Z

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test diffusion
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  file_coord_k          coord_k_0.txt
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 3
    Coarsen_Operator_K { file_z_coord coord_k_1.txt }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.

  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vx_init  0.
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  type_velocity_diffusion none

  turbulent_viscosity
  type_velocity_turbulent_diffusion simple_with_transpose
  turbulent_viscosity_model smagorinsky
  turbulent_viscosity_model_constant 0.16

  large_eddy_simulation_formulation favre

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 D_VELOCITY TEMPERATURE

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
dimension 2
Pb_Thermohydraulique_QC pb

Domaine dom

# DEBUT MAILLAGE #
Mailler dom
	{
	Pave Cavite
		{
		Origine 0. 0.
		Nombre_de_Noeuds 2 21
		Longueurs  1 20
		}
		{
		Bord bas   Y = 0.     0. <= X <=    1. 
		Bord haut  Y = 20    0. <= X <=     1.
		Bord cote  X = 0.     0. <= Y <=    20.
		Bord cote  X = 1.     0. <= Y <=    20.
		}
	}
# FIN MAILLAGE #

# DEBUT DECOUPAGE 
Decouper dom
{
	partitionneur Tranche  { tranches 1 2 1 }
	Larg_joint 2
	Nom_Zones canalQCdt20K
	Periodique 2 periox perioz
}
Fin
 FIN DECOUPAGE #

# DEBUT LECTURE 
Scatter canalQCdt20K.Zones dom
 FIN LECTURE #

VDF dis

Schema_Euler_explicite sch
Runge_Kutta_ordre_3_QC sch0
Lire sch
{
        tinit 0.
        tmax 12.
        dt_min 1.e-11
        dt_max 1.
	dt_start dt_fixe 1.e-11
        dt_impr 1.e-7
        dt_sauv 1.
        seuil_statio 1.e-8
}

Fluide_Quasi_Compressible fluide
Lire fluide
{
        mu Champ_Fonc_Fonction 1 temperature 2.e-5
        lambda Champ_Fonc_Fonction 1 temperature 3.e-2
        pression 100000.
        loi_etat gaz_parfait 	{
                		Prandtl 0.76
                		Cp 1005
                		gamma 1.4
        			}
	traitement_pth constant
}

Associer pb dom
Associer pb sch
Associer pb fluide

Discretiser pb dis

Lire pb
{
        Navier_Stokes_QC
        {
                solveur_pression GCP { optimized precond ssor { omega 1.5 } seuil 1.e-12 impr }
                convection { centre }
                diffusion { negligeable }
                Sources 
		{ 
		}
		conditions_initiales 
		{
                        vitesse champ_uniforme 2 0. 0.
                }
                conditions_limites 
		{
			haut     frontiere_ouverte_pression_imposee Champ_front_Uniforme 1 0.
			bas      paroi_fixe
			cote	 symetrie
                }
		
		
  
	}
				
        Convection_Diffusion_Chaleur_QC
        {
                diffusion { negligeable }
		mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU
                convection { quick }
		Sources { Puissance_thermique Champ_Uniforme_Morceaux dom 1 { Defaut 1000. } }
		conditions_initiales { Temperature Champ_Uniforme 1 350. }
		conditions_limites 
                {
 		        haut frontiere_ouverte T_ext Champ_Front_Uniforme 1  350.
			bas paroi_adiabatique
			cote symetrie
		}
    
        }

        Postraitement
         { 

		Sondes {
Sonde_P pression periode 1 segment 20 0.5 0.5 0.5 19.5
}

			
			format lata
			Champs dt_post 1.
			{
      				vitesse elem
      				masse_volumique elem
				pression elem
				temperature elem
      				
         		}
        															        
        }

}
EcritureLectureSpecial 0
Resoudre pb
Fin
# Faire load "memplot" dans gnuplot
# On definit le coefficient A tq
# Commande pour generer le bon fichier evol_glob (une ligne sur 8)
# awk '{if(NR % 8==0)print $0}' evol_glob > evol_glob_1_ligne_sur_8
q=1000.
Pth=100000.
r=Pth/(350*0.995025)
Cp=1005.
A=r*q/(Pth*Cp)
rho=0.995025
set autoscale;
set term x11 1;
plot "evol_glob_1_ligne_sur_8" u 1:3,"evol_glob_1_ligne_sur_8" u 1:(rho*exp(-A*$1))
set term x11 2;
plot "evol_glob_1_ligne_sur_8" u 1:(($3-rho*exp(-A*$1))/$3) # 
Test diffusion
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  nbelem_k 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  uniform_domain_size_k 1.
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 2
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.

  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vx_init  0.
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  type_velocity_diffusion none

  structural_uu
  structural_uu_model gradient
  structural_uu_model_constant 1.

  large_eddy_simulation_formulation velocity

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 D_VELOCITY TEMPERATURE

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test diffusivite turbulente (dans energie)
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 72
  nbelem_j 72
  uniform_domain_size_i 0.187528
  uniform_domain_size_j 0.093764
  file_coord_k          coord_k_0.txt
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 4
    Coarsen_Operator_K { file_z_coord coord_k_1.txt } 
    Coarsen_Operator_K { file_z_coord coord_k_2.txt }
    Coarsen_Operator_Uniform { coarsen_i 1 coarsen_j 2 coarsen_k 2 }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 4 5 5 8 8 
    smooth_steps     4 5 5 8 8  
    
    relax_jacobi 4 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 4 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.
  
  expression_t_init   293.+293/0.029846*z
  expression_vx_init  3.339*z*(0.029846-z)*4/(0.029846*0.029846)
  expression_vy_init  0.
  expression_vz_init  (sin((x-0.187528)/0.187528*6.28318530717959)*sin(y/0.093764*6.28318530717959)+sin((x-0.187528)/0.187528*6.28318530717959*6)*sin(y/0.093764*6.28318530717959*4)+sin((x-0.187528)/0.187528*6.28318530717959*2)*sin(y/0.093764*6.28318530717959*8))*z*(0.029846-z)*4/(0.029846*0.029846) 

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_34.sauv
  check_stop_file     stop_file

  sauvegarde_post_instantanes
  champs_a_postraiter 2 TEMPERATURE DRHO_DT

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 586.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.011109385
}
 # 
Test diffusion
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  nbelem_k 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  uniform_domain_size_k 1.
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 2
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.

  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vx_init  0.
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  type_velocity_diffusion none

  structural_uu
  structural_uu_model su_laplacien_u
  structural_uu_model_constant 1.

  large_eddy_simulation_formulation favre
  filter_kernel_name box

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 D_VELOCITY TEMPERATURE

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
# Test pour verifications des proprietes thermodynamiques lambda, rho et mu de T #

IJK_Grid_Geometry grid_geom

Lire grid_geom
{
  nbelem_i 4
  nbelem_j 4
  nbelem_k 32
  uniform_domain_size_i 0.023441
  uniform_domain_size_j 0.03
  uniform_domain_size_k 0.029846
  perio_i
  perio_j
}
IJK_Splitting grid_splitting
Lire grid_splitting { ijk_grid_geometry grid_geom  nproc_i 1  nproc_j 1  nproc_k 1 }

dns_qc_double 
{
  ijk_splitting grid_splitting
  timestep 0.001
  timestep_facsec 1.
  nb_pas_dt_max 1
/* tinit 0. */
  multigrid_solver { 
    coarsen_operators 1
	Coarsen_Operator_Uniform { coarsen_i 1 coarsen_j 1 coarsen_k 2 }
    ghost_size 1
    pre_smooth_steps 1 5
    smooth_steps 1 5
    relax_jacobi 1 0.65
    solveur_grossier GCP { seuil  0.5e-25 precond ssor { omega 1.5 } impr }
    seuil 1.e-20
    nb_full_mg_steps 2 5 1
    solver_precision mixed
  }
  champs_a_postraiter 1 tous
dt_post 1
sauvegarde_post_instantanes 
  t_paroi_impose_kmin 200
  t_paroi_impose_kmax 1000
  p_thermo_init       214072
  cp                  1005.0
  gamma               1.4

  
  debit_massique 0.
  dumping_factor 1e99
expression_vx_init 0.
  expression_vy_init 0.
  expression_vz_init 0.
  expression_t_init 200+800*z/0.029846
}
# pour NR #
system "ln -sf *_1.sauv.lata qc_ijk_proprietes_thermo_jdd1.lata"
# lata convert #
Fin
 # 
Test diffusion
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  nbelem_k 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  uniform_domain_size_k 1.
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 2
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.

  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vx_init  0.
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  type_velocity_diffusion none

  turbulent_viscosity
  type_velocity_turbulent_diffusion simple_with_transpose_anisotropic
  turbulent_viscosity_model smagorinsky
  turbulent_viscosity_model_constant 0.16

  large_eddy_simulation_formulation favre

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 D_VELOCITY TEMPERATURE

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test modele gradient pour u/rho
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 100
  nbelem_j 100
  nbelem_k 100
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  uniform_domain_size_k 1.
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 2
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.
  
  diffusion_temp_negligeable

  expression_t_init   293.*(1+exp(-(x-.5)*(x-.5)/(.1*.1)-(y-.5)*(y-.5)/(.1*.1)-(z-.5)*(z-.5)/(.1*.1)))
  expression_vx_init 2.*0.001*sin(X*6.28318530717958647)*sin(z*6.28318530717958647*2.)
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_34.sauv
  check_stop_file     stop_file

  structural_uscalar
  structural_uscalar_model gradient
  structural_uscalar_model_constant 1.

  large_eddy_simulation_formulation favre

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 5 TEMPERATURE DIV_LAMBDA_GRAD_T_VOLUME STRUCTURAL_USCALAR_X STRUCTURAL_USCALAR_Y STRUCTURAL_USCALAR_Z

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
dimension 2
Pb_Thermohydraulique_Turbulent_QC pb

Domaine dom

# DEBUT MAILLAGE #
Mailler dom
	{
	Pave Cavite
		{
		Origine 0. 0.
		Nombre_de_Noeuds 17 33 
		Longueurs  0.093764 0.029846
		tanh_taille_premiere_maille 8.29e-5
		}
		{
		Bord periox   X = 0.          0. <= Y <= 0.029846    
		Bord periox   X = 0.093764    0. <= Y <= 0.029846   
		Bord bas      Y = 0.          0. <= X <= 0.093764    
		Bord haut     Y = 0.029846    0. <= X <= 0.093764  
		}
	}
# FIN MAILLAGE #

# DEBUT DECOUPAGE 
Decouper dom
{
	partitionneur Tranche  { tranches 2 3  }
	Larg_joint 2
	Nom_Zones canalQCdt20K
	Periodique 1 periox
}
Fin
 FIN DECOUPAGE #

# DEBUT LECTURE 
Scatter canalQCdt20K.Zones dom
 FIN LECTURE #

VDF dis


Runge_Kutta_Rationnel_ordre_2 sch_ex 
/*

schema_euler_explicite sch_ex

*/
Lire sch_ex
{
        tinit 0.
	nb_pas_dt_max 3000 
        tmax 0.25
        dt_min 1.e-11
        dt_max 5.
        dt_impr 1.e-7
        dt_sauv 0.05
	dt_start dt_calc
        seuil_statio 1.e-8
	facsec 1
	diffusion_implicite 0
}


Fluide_Quasi_Compressible fluide
Lire fluide
{
        mu Champ_Fonc_Fonction 1 temperature (1.461e-6*((100000./(287.14*val))^1.5)/((100000./(287.14*val))+111.))
        lambda Champ_Fonc_Fonction 1 temperature (1.93198026315789000e-3*((100000./(287.14*val))^1.5)/((100000./(287.14*val))+111.))
        pression 100000.
        loi_etat gaz_parfait 	{
                		Prandtl 0.76
                		Cp 1005
                		gamma 1.4
        			}
	traitement_pth conservation_masse
}

Associer pb dom
Associer pb sch_ex
Associer pb fluide

Discretiser pb dis

Lire pb
{
        Navier_Stokes_Turbulent_QC
        {
                solveur_pression GCP { optimized precond ssor { omega 1.5 } seuil 1.e-7 impr }
                convection { quick }
                diffusion { }
                Sources 
		{ 
			Canal_perio { Bord periox h 0.0149 } 
		}	
		conditions_initiales 
		{
                        vitesse champ_init_canal_sinal 2  { Ucent 15. h 0.0149  ampli_sin 2. omega 67.01 ampli_bruit 2. dir_wall 1 dir_flow 0 }
                }
                conditions_limites 
		{
                        periox   periodique 
			haut     paroi_fixe
			bas      paroi_fixe
                }
		Modele_turbulence sous_maille_wale
		{
			turbulence_paroi negligeable
			cw 0.5
		} 
		Traitement_particulier
                    		{
                                Canal
                            			{
                                                dt_impr_moy_spat 0.025
                                                dt_impr_moy_temp 0.025
						debut_stat 10.
						fin_stat 20.
						}
                                } 
  
	}
				
        Convection_Diffusion_Chaleur_Turbulent_QC
        {
                diffusion { }
                convection { centre }
		Sources {	}	
		conditions_initiales { Temperature Champ_Fonc_xyz dom 1 263.+293.*y/0.029846 }
		conditions_limites 
                {
                 	periox periodique 
 		        haut paroi_flux_impose Champ_Front_Uniforme 1  170.
			bas paroi_flux_impose Champ_Front_Uniforme 1  -170.
		}
    Modele_turbulence Prandtl
		{ 
 		turbulence_paroi negligeable_scalaire 
		}
        }

        Postraitement
         { 

	
			
			format lata
			Champs dt_post 0.025
			{
      				vitesse elem
      				masse_volumique elem
/* temperature_qc elem
viscosite_dynamique elem */
				pression elem
      				viscosite_turbulente elem
				Vorticite elem
				Critere_Q elem
         		}
        	 Statistiques dt_post 0.025
		 {
			t_deb 10. t_fin 20.
			moyenne vitesse
			}										        
        }
	
	sauvegarde formatte canal_turb.sauv

}

Resoudre pb
Fin
 # 
Test diffusion
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  nbelem_k 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  uniform_domain_size_k 1.
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 2
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.

  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vx_init  0.
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  type_velocity_diffusion none

  structural_uu
  structural_uu_model gradient
  structural_uu_model_constant 1.

  large_eddy_simulation_formulation favre

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 D_VELOCITY TEMPERATURE

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test conduction
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 100
  nbelem_j 100
  nbelem_k 100
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  uniform_domain_size_k 1.
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 2
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.
  
  expression_t_init   293.*(1+exp(-(x-.5)*(x-.5)/(.1*.1)-(y-.5)*(y-.5)/(.1*.1)-(z-.5)*(z-.5)/(.1*.1)))
  expression_vx_init  0.
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_34.sauv
  check_stop_file     stop_file

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 TEMPERATURE DIV_LAMBDA_GRAD_T_VOLUME

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test diffusivite turbulente (dans energie)
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 100
  nbelem_j 100
  nbelem_k 100
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  uniform_domain_size_k 1.
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 2
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.
  
  diffusion_temp_negligeable

  expression_t_init   293.*(1+exp(-(x-.5)*(x-.5)/(.1*.1)-(y-.5)*(y-.5)/(.1*.1)-(z-.5)*(z-.5)/(.1*.1)))
  expression_vx_init 2.*0.001*sin(X*6.28318530717958647)*sin(z*6.28318530717958647*2.)
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_34.sauv
  check_stop_file     stop_file

  turbulent_diffusivity
  type_scalar_turbulent_diffusion normal
  turbulent_diffusivity_model smagorinsky
  turbulent_diffusivity_model_constant .16

  large_eddy_simulation_formulation favre

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 3 TEMPERATURE DIV_LAMBDA_GRAD_T_VOLUME TURBULENT_KAPPA

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
dimension 2
Pb_Thermohydraulique_Turbulent_QC pb

Domaine dom

# DEBUT MAILLAGE #
Mailler dom
	{
	Pave Cavite
		{
		Origine 0. 0. 
		Nombre_de_Noeuds 10 20 
		Longueurs  0.09 0.03
		}
		{
		Bord periox   X = 0.          0. <= Y <= 0.03 
		Bord periox   X = 0.09	    0. <= Y <= 0.03  
		Bord bas      Y = 0.          0. <= X <= 0.09 
		Bord haut     Y = 0.03    0. <= X <= 0.09 
		}
	}
# FIN MAILLAGE #

# DEBUT DECOUPAGE 
Decouper dom
{
	partitionneur Tranche  { tranches 1 2 1 }
	Larg_joint 2
	Nom_Zones canalQCdt20K
	Periodique 2 periox perioz
}
Fin
 FIN DECOUPAGE #

# DEBUT LECTURE 
Scatter canalQCdt20K.Zones dom
 FIN LECTURE #

VDF dis

Runge_Kutta_ordre_3 sch
Lire sch
{
        tinit 0.
        tmax 50.
        dt_min 1.e-11
        dt_max 10.
        dt_impr 1.e-7
        dt_sauv 1
        seuil_statio 1.e-8
}

Fluide_Quasi_Compressible fluide
Lire fluide
{
        mu Champ_Fonc_Fonction 1 temperature 2.e-5
        lambda Champ_Fonc_Fonction 1 temperature 3.e-2
        pression 100000.
        loi_etat gaz_parfait 	{
                		Prandtl 0.76
                		Cp 1005
                		gamma 1.4
        			}
	traitement_pth conservation_masse
}

Associer pb dom
Associer pb sch
Associer pb fluide

Discretiser pb dis

Lire pb
{
        Navier_Stokes_Turbulent_QC
        {
                solveur_pression GCP { precond ssor { omega 1.5 } seuil 1.e-7 impr }
                convection { centre }
                diffusion { }
                Sources 
		{ 
		}
		conditions_initiales 
		{
                        vitesse champ_uniforme 2 0. 0.
                }
                conditions_limites 
		{
                        periox   periodique
			haut     paroi_fixe
			bas      paroi_fixe
                }
		Modele_turbulence sous_maille_wale
		{
			turbulence_paroi negligeable
			cw 0.5
		} 
		Traitement_particulier
                    		{
                                Canal
                            			{
                                                dt_impr_moy_spat .4
                                                dt_impr_moy_temp 10.
						debut_stat 10.
						fin_stat 50.
						}
                                } 
  
	}
				
        Convection_Diffusion_Chaleur_Turbulent_QC
        {
                diffusion { }
		mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU
                convection { quick }
		Sources { }	
		conditions_initiales { Temperature Champ_Uniforme 1 348.2621717629 }
		conditions_limites 
                {
                 	periox periodique
 		        haut paroi_flux_impose Champ_Front_Uniforme 1  200.
			bas paroi_flux_impose Champ_Front_Uniforme 1  -200.
		}
    Modele_turbulence Prandtl
		{ 
 		turbulence_paroi negligeable_scalaire 
		}
        }

        Postraitement
         { 

	
			
			format lata
			Champs dt_post 2.
			{
      				vitesse elem
      				masse_volumique elem
				pression elem
				temperature elem
      				viscosite_turbulente elem
         		}
        	 Statistiques dt_post 2.
		 {
			t_deb 10. t_fin 20.
			moyenne vitesse
			moyenne temperature
			}															        
        }
	sauvegarde formatte laminaire_flux_impose.sauv
}

EcritureLectureSpecial 0
Resoudre pb

Fin
 # Canal turbulent anisotherme #
# PARALLEL NOT #

IJK_Grid_Geometry grid_geom
Lire grid_geom
{
  nbelem_i 72
  nbelem_j 48
  uniform_domain_size_i 0.093764
  uniform_domain_size_j 0.062509
  file_coord_k          coord_k_0.txt
  perio_i
  perio_j
}

IJK_Splitting grid_splitting
Lire grid_splitting
{
  ijk_grid_geometry grid_geom
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

IJK_Splitting post_splitting
Lire post_splitting
{
  ijk_grid_geometry grid_geom
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting
  timestep 1
  nb_pas_dt_max 250

/* tinit 0. */
  multigrid_solver
  {
    coarsen_operators 5
    Coarsen_Operator_K { file_z_coord coord_k_1.txt } 
    Coarsen_Operator_K { file_z_coord coord_k_2.txt }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-8
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
sauvegarde_post_instantanes   
  tinit 0.
  
  expression_t_init   293.+293/0.029846*z
  expression_vx_init  3.339*z*(0.029846-z)*4/(0.029846*0.029846)
  expression_vy_init  0.
  expression_vz_init  (sin((x-0.093764)/0.093764*6.28318530717959)*sin(y/0.062509*6.28318530717959)+sin((x-0.093764)/0.093764*6.28318530717959*6)*sin(y/0.062509*6.28318530717959*4)+sin((x-0.093764)/0.093764*6.28318530717959*2)*sin(y/0.062509*6.28318530717959*8))*z*(0.029846-z)*4/(0.029846*0.029846) 

  dt_post             2500
# spectral_splitting  post_splitting
  dt_post_spectral    10000 # 
  dt_sauvegarde       10000

  nom_sauvegarde      dns_1.sauv
  check_stop_file     stop_file

  turbulent_viscosity
  type_velocity_turbulent_diffusion simple_with_transpose
  turbulent_viscosity_model amd
  turbulent_viscosity_model_constant 0.3

  turbulent_diffusivity
  type_scalar_turbulent_diffusion normal
  turbulent_diffusivity_model smagorinsky
  turbulent_diffusivity_model_constant 0.5798 # 0.55/sqrt(Pr); Pr=0.9 #

  large_eddy_simulation_formulation velocity

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 586.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.007406252649
}
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  81 81 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.001 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  11 11 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  21 21 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.01 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  81 81 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.01 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  41 41 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  11 11 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  41 41 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.001 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  11 11 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  41 41 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.01 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  81 81 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  41 41 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  11 11 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.001 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  21 21 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.001 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  41 41 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  81 81 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  11 11 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  21 21 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  21 21 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  21 21 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.001 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  11 11 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  41 41 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  81 81 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  81 81 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.01 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  41 41 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.01 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  41 41 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.001 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  21 21 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.01 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  11 11 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.001 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  21 21 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  81 81 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  11 11 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.01 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  11 11 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.01 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  21 21 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  81 81 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
Runge_Kutta_ordre_3_qc    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 0.001 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
# Test dirchlet entree #
# PARALLEL OK 8 #

dimension 2
Domaine dom_canal

# DEBUT MAILLAGE #
Mailler dom_canal
        {
        Pave Cavite
                {
                Origine 0. 0.
		 /* Nombre_de_Noeuds  79 79 */  
		 Nombre_de_Noeuds  11 11 
		Longueurs  6.28318530717959 6.28318530717959
		}

                {
		Bord entree   X = 0.                      0. <= Y <= 6.28318530717959
                Bord sortie   X = 6.28318530717959        0. <= Y <= 6.28318530717959    
                Bord perioy   Y = 0.            	  0. <= X <= 6.28318530717959  
                Bord perioy   Y = 6.28318530717959        0. <= X <= 6.28318530717959     

                }
        }

# FIN MAILLAGE #
# DEBUT DECOUPAGE

Decouper dom_canal
{
        Partitionneur tranche { tranches 2 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 perioy
}
Fin
FIN DECOUPAGE #


# DEBUT LECTURE 
Scatter DOM.Zones dom_canal
 FIN LECTURE #

Pb_Thermohydraulique_turbulent_QC pb_canal

VDF dis

# Schéma en temps #


  # Runge_Kutta_ordre_3_qc  #
schema_euler_explicite    sch_qc   
lire sch_qc

{
        tinit 0
        tmax 6.28318530717959
tmax 9.4247779607693847
tmax 3.1415926
tmax 1.57

        dt_min 1.e-11
         /* dt_max 0.032 
        dt_impr 1.e-7 
        dt_start dt_fixe 0.00000000002 */
        
        seuil_statio 1.e-12
        facsec 1 
        diffusion_implicite 0
        nb_pas_dt_max 400000
}


# fluide  #
Fluide_Quasi_Compressible fuilde_canal
Lire fuilde_canal
{
        mu Champ_uniforme 1 1.461e-6
        pression 100000.
        lambda Champ_uniforme  1  2.06803521126761000000e-3
        loi_etat gaz_parfait 	{
                		Prandtl 0.71
                		Cp 1005
                		gamma 1.4
        			}

	  traitement_pth constant       

}

Option_VDF
{
   traitement_coins oui
}

# Association #
Associer pb_canal dom_canal
Associer pb_canal fuilde_canal
Associer pb_canal sch_qc
Discretiser pb_canal dis

# definition problème 2 #
Lire pb_canal
{ 
	# Navier Stokes #
        Navier_Stokes_turbulent_QC
        {
        	# Résolution de la pression #
		solveur_pression  GCP { precond ssor { omega 1.5 } seuil 1.e-14   }
                projection_initiale 0								

               # Modèle de turbulence #
		modele_turbulence sous_maille_WALE { turbulence_paroi negligeable Cw 0. }

		# schéma de calcul #
		convection { amont }
	convection { quick }
	    diffusion { negligeable }
    	Sources { }		

		#  #

		conditions_initiales 
		{   vitesse champ_fonc_xyz dom_canal 	2  0.1*sin(x-y)+1 0.1*sin(x-y) }
                                                                                                                                             

                conditions_limites 

				{
                        entree  frontiere_ouverte_vitesse_imposee Champ_front_fonc_txyz 2  0.1*sin(x-y-t)+1 0.1*sin(x-y-t) 	
			sortie	frontiere_ouverte_pression_imposee champ_front_uniforme 1 0.		                       
			perioy periodique
                }
	}

	# Thermique #				
        Convection_Diffusion_Chaleur_turbulent_QC
        {
        	# Modèles thermique tubulent #
			Modele_Turbulence Prandtl { turbulence_paroi negligeable_scalaire }
			# mode_calcul_convection DIVRHOUT_MOINS_TDIVRHOU  #

			# Schémas de calcul #
			diffusion { negligeable }
		
			convection { centre4 }
			convection { amont }
			convection { quick }
			Sources { }	

			conditions_initiales { Temperature Champ_Fonc_xyz dom_canal 1  100000/(287.1428571428*(1+0.1*sin(x-y))) } 

			conditions_limites 

            {

                 	entree entree_temperature_imposee_H Champ_front_Fonc_txyz 1 100000/(287.1428571428*(1+0.1*sin(x-y-t)))  
					sortie Frontiere_ouverte T_ext Champ_Front_Uniforme 1 293.
					perioy periodique
			}

        }

	Postraitement
        	{
	definition_champs 
{
erreur_masse	champ_post_transformation  {
 methode formule expression 1 abs(masse_volumique_natif_dom_canal-(1+0.1*sin(x-y-t)))
sources {  champ_post_refchamp { pb_champ pb_canal masse_volumique }  }
}
max_erreur_masse champ_post_reduction_0D {
 methode max
 source_reference erreur_masse 
}

	}

        	 		format lata
                	Champs dt_post 1
                	{
                         masse_volumique elem
			vitesse elem
			
                        }
        	
        	Sondes          # Taille d'une face : 0.0805536578        taille d'une demi face :   0.0402768289  #
        		{ 
			   				
		max_erreur_masse max_erreur_masse periode 1e-7 numero_elem_sur_maitre 0	
				seg_rho_m grav masse_volumique periode 0.0001 points 1 3.18186948 3.18186948
        				
			   			       				
			
				seg_rho_s grav masse_volumique periode 0.0001 points 1 6.24290848 3.18186948
        				
			}
        	
        	        	
        	
        	
        	
        	
           	
		}


}




Resoudre pb_canal
fin
 # 
Test diffusion
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  file_coord_k          coord_k_0.txt
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 3
    Coarsen_Operator_K { file_z_coord coord_k_1.txt }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.

  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vX_init 2.*0.001*sin(Y*6.28318530717958647)*sin(z*6.28318530717958647*2.)
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 D_VELOCITY TEMPERATURE

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test diffusion
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  file_coord_k          coord_k_0.txt
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 3
    Coarsen_Operator_K { file_z_coord coord_k_1.txt }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.

  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vx_init  0.
  expression_vy_init  0.
  expression_vZ_init 2.*0.001*sin(X*6.28318530717958647)*sin(z*6.28318530717958647*2.)

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 D_VELOCITY TEMPERATURE

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test diffusion
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  file_coord_k          coord_k_0.txt
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 3
    Coarsen_Operator_K { file_z_coord coord_k_1.txt }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.

  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vX_init 2.*0.001*sin(X*6.28318530717958647)*sin(z*6.28318530717958647*2.)
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 D_VELOCITY TEMPERATURE

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test diffusion
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  file_coord_k          coord_k_0.txt
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 3
    Coarsen_Operator_K { file_z_coord coord_k_1.txt }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.

  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vx_init  0.
  expression_vY_init 2.*0.001*sin(Y*6.28318530717958647)*sin(z*6.28318530717958647*2.)
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 D_VELOCITY TEMPERATURE

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test diffusion
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  file_coord_k          coord_k_0.txt
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 3
    Coarsen_Operator_K { file_z_coord coord_k_1.txt }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.

  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vx_init  0.
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 D_VELOCITY TEMPERATURE

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test diffusion
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  file_coord_k          coord_k_0.txt
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 3
    Coarsen_Operator_K { file_z_coord coord_k_1.txt }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.

  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vx_init  0.
  expression_vy_init  0.
  expression_vZ_init 2.*0.001*sin(Y*6.28318530717958647)*sin(z*6.28318530717958647*2.)

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 D_VELOCITY TEMPERATURE

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test diffusion
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  file_coord_k          coord_k_0.txt
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 3
    Coarsen_Operator_K { file_z_coord coord_k_1.txt }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.

  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vx_init  0.
  expression_vY_init 2.*0.001*sin(X*6.28318530717958647)*sin(z*6.28318530717958647*2.)
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 D_VELOCITY TEMPERATURE

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
 # 
Test diffusion
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  file_coord_k          coord_k_0.txt
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 1
  multigrid_solver
  {
    coarsen_operators 3
    Coarsen_Operator_K { file_z_coord coord_k_1.txt }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.

  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vx_init  0.
  expression_vy_init  0.
  expression_vz_init  0.

  dt_post             1
  dt_sauvegarde       1

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  type_velocity_diffusion none

  turbulent_viscosity
  type_velocity_turbulent_diffusion simple_with_transpose
  turbulent_viscosity_model smagorinsky
  turbulent_viscosity_model_constant 0.16

  large_eddy_simulation_formulation velocity

  postraiter_sous_pas_de_temps
  sauvegarde_post_instantanes
  champs_a_postraiter 2 D_VELOCITY TEMPERATURE

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
# Generate an initial condition with div(u)=0 for vdf and ijk comparison #
# Save both reprise and lata format #
# PARALLEL OK #
dimension 3
Pb_Thermohydraulique_QC pb

Domaine dom

MaillerParallel
{
	domain dom
	nb_nodes 3  33 9 17
	splitting 3 1 1 1
	ghost_thickness 2
	perio_x
	perio_y
	function_coord_x 0.187528*x 
	function_coord_y 0.046882*y
	function_coord_z 0.029846*z
	boundary_xmin periox
	boundary_xmax periox
	boundary_ymin perioy
	boundary_ymax perioy
	boundary_zmin bas
	boundary_zmax haut
}

VDF dis

Runge_Kutta_ordre_3_QC sch
Lire sch
{
        tinit 0.
        tmax  20
        dt_min 1.e-11
        dt_max 1.
        dt_impr 1.e-7
        dt_sauv 1
	seuil_statio 1.e-8
	nb_pas_dt_max 5 # condition initiale prise apres 5 pas de temps #
}

Fluide_Quasi_Compressible fluide
Lire fluide
{
        mu Champ_Fonc_Fonction 1 temperature_qc (1.461e-6*(val^1.5)/(val+111.))
        lambda Champ_Fonc_Fonction 1 temperature_qc (1.93198026315789000e-3*val^1.5)/(val+111.)
        pression 214072
        loi_etat gaz_parfait { Prandtl 0.71 Cp 1005 gamma 1.4 }
}

Associer pb dom
Associer pb sch
Associer pb fluide

Discretiser pb dis

IJK_discretization vdf_to_ijk

Lire vdf_to_ijk
{
        vdf_problem pb
        splitting 3 1 1 1
        perio_i
        perio_j
}

Lire pb
{
	Navier_Stokes_QC
	{
		solveur_pression multigrille_adrien 
		{
				coarsen_operators 2
	Coarsen_Operator_Uniform { coarsen_i 1 coarsen_j 1 coarsen_k 2 }
	Coarsen_Operator_Uniform { coarsen_i 1 coarsen_j 1 coarsen_k 2 }
				
				
			ghost_size 1
                        pre_smooth_steps 1 10
                        smooth_steps 1 10
                        relax_jacobi 1 0.65
                        solveur_grossier GCP { seuil  0.5e-17 precond ssor { omega 1.5 } }
                        check_residu 0
                        seuil 2.5e-16
                        nb_full_mg_steps 2 20 1 
			solver_precision double
	
       	}
		convection { centre4 }
		diffusion { }
		conditions_initiales 
		{
                        vitesse champ_fonc_xyz dom 3 
SIN(z*3.14159265358979/0.029846)*0.01+SIN(2*z*3.14159265358979/0.029846)*2
SIN(z*3.14159265358979/0.029846)*SIN(2*x*3.14159265358979/0.187528)*SIN(4*y*3.14159265358979/0.046882)*0.05
SIN(z*3.14159265358979/0.029846)*SIN(4*x*3.14159265358979/0.187528)*SIN(2*y*3.14159265358979/0.046882)*0.05
		}
                conditions_limites 
		{
                        periox   periodique 
			perioy   periodique 
			haut     paroi_fixe
			bas      paroi_fixe
                }
	}				
        Convection_Diffusion_Chaleur_QC
        {
                diffusion { }
                convection { quick }
		Sources {	}	
		conditions_initiales { Temperature Champ_fonc_xyz dom 1 
273+(600-273)*(z/0.029846)+SIN(z*3.14159265358979/0.029846)*SIN(4*x*3.14159265358979/0.187528)*400
} 
		conditions_limites 
                {
                 	periox periodique 
					perioy periodique 
					haut paroi_echange_externe_impose T_ext	Champ_Front_Uniforme 1 600 H_imp Champ_Front_Uniforme 1  1.e14
					bas  paroi_echange_externe_impose T_ext	Champ_Front_Uniforme 1 273 H_imp Champ_Front_Uniforme 1  1.e14
 		}
        }

         Postraitement
         { 
         		
			format lata
			# postraiter uniquement l'etat a la fin du calcul #
			Champs dt_post 1000
			{
      				vitesse faces
				temperature_qc elem
				masse_volumique elem
         		}
    	 }	
	sauvegarde cond_initial.sauv
}
Resoudre pb

Fin

# 
2/6/2013
Benoit Mathieu et Adrien Toutant
Canal turbulent anisotherme pour validation du qc
#

IJK_Grid_Geometry grid_geom

Lire grid_geom
{
  nbelem_i 32
  nbelem_j 8
  nbelem_k 16
  uniform_domain_size_i 0.187528
  uniform_domain_size_j 0.046882 # 0.093764 #
  uniform_domain_size_k 0.029846
  perio_i
  perio_j
}

IJK_Splitting grid_splitting
Lire grid_splitting
{
  ijk_grid_geometry grid_geom
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting
  timestep 1.
  nb_pas_dt_max 50
  multigrid_solver {
   coarsen_operators 2
 	Coarsen_Operator_Uniform { coarsen_i 1 coarsen_j 1 coarsen_k 2 }  
	Coarsen_Operator_Uniform { coarsen_i 1 coarsen_j 1 coarsen_k 2 }
    ghost_size 1
    pre_smooth_steps 1 10
    smooth_steps 1 10
    relax_jacobi 1 0.65
    solveur_grossier GCP { seuil  0.5e-25 precond ssor { omega 1.5 }  }
    check_residu 0
    seuil 2.5e-16
    nb_full_mg_steps 2 20 1
    solver_precision mixed

    
  }
  timestep_facsec 1.
  
  tinit 0.

  dt_post 1
  champs_a_postraiter 2 temperature velocity
  dt_sauvegarde 5000
  check_stop_file dns.stop

  t_paroi_impose_kmin 273
  t_paroi_impose_kmax 600
  p_thermo_init       214072
  cp                  1005.0
  gamma               1.4 

debit_massique 0
dumping_factor 1e99
  nom_reprise reprise_ijk.data
}
# ThermoHydraulique 3D : canal quasi compressible gaz parfait VDF turbulent #
# PARALLEL OK #
dimension 3
Pb_Thermohydraulique_QC pb

Domaine dom

MaillerParallel
{
	domain dom
	nb_nodes 3  33 9 17
	splitting 3 1 1 1
	ghost_thickness 2
	perio_x
	perio_y
	function_coord_x 0.187528*x 
	function_coord_y 0.046882*y
	function_coord_z 0.029846*z
	boundary_xmin periox
	boundary_xmax periox
	boundary_ymin perioy
	boundary_ymax perioy
	boundary_zmin bas
	boundary_zmax haut
}

VDF dis

Runge_Kutta_ordre_3_QC sch
Lire sch
{
	tinit 0.
        tmax  20
        dt_min 1.e-11
        dt_max 1.
        dt_impr 1.e-7
        dt_sauv 100
	seuil_statio 1.e-8
	nb_pas_dt_max 50
}

Fluide_Quasi_Compressible fluide
Lire fluide
{
        mu Champ_Fonc_Fonction 1 temperature_qc (1.461e-6*(val^1.5)/(val+111.))
        lambda Champ_Fonc_Fonction 1 temperature_qc (1.93198026315789000e-3*val^1.5)/(val+111.)
        pression 214072
        loi_etat gaz_parfait { Prandtl 0.71 Cp 1005 gamma 1.4 }
}

Associer pb dom
Associer pb sch
Associer pb fluide

Discretiser pb dis

IJK_discretization vdf_to_ijk

Lire vdf_to_ijk
{
        vdf_problem pb
        splitting 3 1 1 1
        perio_i
        perio_j
}

Lire pb
{
	Navier_Stokes_QC
	{
		solveur_pression multigrille_adrien 
		{
				coarsen_operators 2
	Coarsen_Operator_Uniform { coarsen_i 1 coarsen_j 1 coarsen_k 2 }
	Coarsen_Operator_Uniform {  }
				
				
			ghost_size 1
                        pre_smooth_steps 1 5
                        smooth_steps 1 5
                        relax_jacobi 1 0.65
                        solveur_grossier GCP { seuil  0.5e-18 precond ssor { omega 1.5 } }
                        check_residu 0
                        seuil 2.5e-18
                        nb_full_mg_steps 2 4 1 

			solver_precision mixed
	
       	}
		convection { centre4 }
		diffusion { }
		conditions_initiales 
		{
                        vitesse champ_fonc_xyz dom 3 
SIN(z*3.14159265358979/0.029846)*0.01+SIN(2*z*3.14159265358979/0.029846)*0.005
SIN(z*3.14159265358979/0.029846)*SIN(2*x*3.14159265358979/0.187528)*SIN(4*y*3.14159265358979/0.046882)*0.005
SIN(z*3.14159265358979/0.029846)*SIN(4*x*3.14159265358979/0.187528)*SIN(2*y*3.14159265358979/0.046882)*0.005
		}
                conditions_limites 
		{
                        periox   periodique 
			perioy   periodique 
			haut     paroi_fixe
			bas      paroi_fixe
                }
	}				
        Convection_Diffusion_Chaleur_QC
        {
                diffusion { }
                convection { quick }
		Sources {	}	
		conditions_initiales { Temperature Champ_fonc_xyz dom 1 273+(600-273)*(z/0.029846) } 
		conditions_limites 
                {
                 	periox periodique 
					perioy periodique 
					haut paroi_echange_externe_impose T_ext	Champ_Front_Uniforme 1 600 H_imp Champ_Front_Uniforme 1  1.e14
					bas  paroi_echange_externe_impose T_ext	Champ_Front_Uniforme 1 273 H_imp Champ_Front_Uniforme 1  1.e14
 		}
        }

         Postraitement
         { 
         		
			format lata
			Champs dt_post 0.0001
			{
      				vitesse faces
				temperature_qc elem
				masse_volumique elem
         		}
    	 }	
	reprise binaire cond_initial.sauv
}

Resoudre pb
Fin

 # 
Test diffusion turbulente (schema en temps)
 #

IJK_Grid_Geometry grid_geom2
Lire grid_geom2
{
  nbelem_i 101
  nbelem_j 101
  uniform_domain_size_i 1.
  uniform_domain_size_j 1.
  file_coord_k          coord_k_0.txt
  perio_i
  perio_j
}

IJK_Splitting grid_splitting2
Lire grid_splitting2
{
  ijk_grid_geometry grid_geom2
  nproc_i 1
  nproc_j 1
  nproc_k 1
}

dns_qc_double 
{
  ijk_splitting grid_splitting2
  timestep 1
  nb_pas_dt_max 15
  multigrid_solver
  {
    coarsen_operators 3
    Coarsen_Operator_K { file_z_coord coord_k_1.txt }
    Coarsen_Operator_Uniform {  }
    Coarsen_Operator_Uniform {  }
    
    ghost_size 3
    pre_smooth_steps 5 5 5 5 8 8 
    smooth_steps     5 5 5 5 8 8  
    
    relax_jacobi 5 0.69 0.69 0.69 0.65 0.65
    solveur_grossier GCP { seuil  0.5e-9 precond ssor { omega 1.5 } }
    check_residu 0
    seuil 2.5e-9
    nb_full_mg_steps 2 3 1
    solver_precision mixed
    /* impr */
  }
  timestep_facsec 1.
  
  tinit 0.
  
  convection_qdm_negligeable
  convection_rho_negligeable
  disable_solveur_poisson
  expression_t_init   293.
  expression_vx_init  2.*0.001*cos(X*6.28318530717958647*8.)*cos(z*6.28318530717958647*8.)
  expression_vy_init  0.
  expression_vz_init  2.*0.001*sin(X*6.28318530717958647*8.)*sin(z*6.28318530717958647*8.)

  dt_post             15
  dt_sauvegarde       15

  nom_sauvegarde      dns_32.sauv
  check_stop_file     stop_file

  type_velocity_diffusion none

  turbulent_viscosity
  type_velocity_turbulent_diffusion simple
  turbulent_viscosity_model constant
  turbulent_viscosity_model_constant 1e-5

  large_eddy_simulation_formulation favre

  sauvegarde_post_instantanes
  champs_a_postraiter 1 TOUS

  t_paroi_impose_kmin 293.0
  t_paroi_impose_kmax 293.0
  p_thermo_init       1.5e5
  cp                  1005.0
  gamma               1.4 
  debit_massique      0.
}
